<div class="calendar-container seeker-view">
  
  <div class="header">
    <button (click)="previousMonth()">
      <mat-icon style="vertical-align: middle;">chevron_left</mat-icon> Prev
    </button>
    <h2>{{ currentMonth | date:'MMMM yyyy' }}</h2>
    <button (click)="nextMonth()">
      Next <mat-icon style="vertical-align: middle;">chevron_right</mat-icon>
    </button>
  </div>

  <div class="day-names">
    <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
  </div>

  <div class="days-grid">
    @for (day of daysInMonth; track $index) {
      <div
        class="day"
        [class.disabled]="!day.isCurrentMonth || !day.isBookable"
        [class.selected]="day === selectedDateData"
        [class.bookable]="day.isBookable"
        [class.booked]="day.availability?.status === 'booked'"
        (click)="selectDay(day)"
      >
        @if (day.date) {
          <span class="day-number">{{ day.date.getDate() }}</span>
          
          @if (day.isBookable && day.availability?.status !== 'booked') {
            <span class="price">
              {{ day.availability.customPrice !== null ? (day.availability.customPrice | currency:'USD':'symbol':'1.0-0') : (basePrice | currency:'USD':'symbol':'1.0-0') }}
            </span>
          }

          @if (day.availability?.status === 'booked') {
            <div class="booked-dot"></div>
          }
        }
      </div>
    }
  </div>
</div>

@if (showTimeSlotModal && selectedDateData) {
  <div class="modal-overlay">
    <div class="modal-content">
    <button class="close-btn" (click)="closeTimeSlotModal()">&times;</button>
    
    <h3>Request Quote: {{ service!.businessName }}</h3>
    <p class="modal-subtitle">Fill in the details below to receive a custom quote.</p>
    
    <div class="form-group">
      <label for="jobLocation">Your Job Location:</label>
      <div #addressInput class="modern-autocomplete-container"  ></div>
      @if (seekerJobLocation) {
        <div class="address-confirmation-pill fade-in">
          <mat-icon>location_on</mat-icon>
          <span>{{ seekerJobLocation }}</span>
        </div>
      } @else {
        <small class="hint-text">Enter the location to help calculate potential travel fees.</small>
      }
    </div>

    <div class="form-group">
      <label for="jobDescription">Job & Package Details:</label>
      <textarea 
        id="jobDescription" 
        rows="4"
        [(ngModel)]="seekerJobDescription" 
        placeholder="e.g., 'Looking for a 4-hour face painting package' or 'Custom 18x24 oil portrait request. Please include details about style or themes.'"
        required
      ></textarea>
    </div>

    <div class="job-time-selector">
      <div class="form-group">
        <label for="startTime">Preferred Start Time (Optional):</label>
        <input id="startTime" type="time" [(ngModel)]="selectedStartTime">
        <small class="hint-text">Leave blank if time is TBD or for project-based work.</small>
      </div>
      
      <div class="form-group">
        <label for="durationHours">Duration (Hours):</label>
        <input id="durationHours" type="number" [(ngModel)]="selectedDurationHours" (change)="calculateFee()" min="0">
        <small class="hint-text">Approximate time needed.</small>
      </div>
    </div>

    <div class="fee-summary flexible-summary">
      <div class="estimate-detail">
        <span class="label">Base Rate</span>
        <span class="value">{{ selectedDateData.availability.customPrice !== null ? 
                          (selectedDateData.availability.customPrice | currency) : 
                          (basePrice | currency) }}/hr</span>
      </div>
      
      <div class="estimate-detail highlighted">
        <span class="label">Travel & Setup Fees</span>
        <span class="value status-tbd">TBD (To be calculated by provider)</span>
      </div>

      <div class="total-quote-row">
        <div class="label-group">
          <span class="final-label">Initial Estimate</span>
          <small>Final total will be confirmed in chat</small>
        </div>
        <span class="final-value">{{ (selectedDurationHours > 0 ? calculatedJobFee : 0) | currency }} + TBD</span>
      </div>
    </div>
    
    <button 
      class="request-btn" 
      [disabled]="!seekerJobLocation || !seekerJobDescription" 
      (click)="sendBookingRequestFromModal()">
      Send Inquiry for Quote
    </button>
  </div>
  </div>
  <!-- <div class="modal-overlay">
    <div class="modal-content">
      <button class="close-btn" (click)="closeTimeSlotModal()">&times;</button>
      
      <h3>Book {{ service!.businessName }} on {{ selectedDateData.date | date:'mediumDate' }}</h3>
      
      <div class="form-group">
          <label for="jobLocation">Your Job Location:</label>
          <input 
            id="jobLocationAutocomplete" type="text" 
            [(ngModel)]="seekerJobLocation" 
            (input)="handleTimeOrLocationChange()" 
            placeholder="Start typing your full address..."
            #addressInput> </div>
     <div class="form-group">
          <label for="jobDescription">Job Description / Specific Instructions:</label>
          <textarea 
            id="jobDescription" 
            rows="4"
            [(ngModel)]="seekerJobDescription" 
            placeholder="e.g., We are looking for cartoon style"
            required
          ></textarea> </div>
      <div class="job-time-selector">
          <div class="form-group">
              <label for="startTime">Start Time:</label>
              <input id="startTime" type="time" [(ngModel)]="selectedStartTime" required>
          </div>
          
          <div class="form-group">
              <label for="durationHours">Duration (Hours):</label>
              <input id="durationHours" type="number" [(ngModel)]="selectedDurationHours" (change)="calculateFee()" min="1" required>
          </div>
      </div>

      <div class="fee-summary">
          <p class="estimate-detail">
              Base Hourly Rate: <span class="value">{{ selectedDateData.availability.customPrice !== null ? 
                                (selectedDateData.availability.customPrice | currency:'USD':'symbol':'1.0-2') : 
                                (basePrice | currency:'USD':'symbol':'1.0-2') 
                                }}</span>
          </p>
          <p class="estimate-detail">
              Estimated Driving Time (Round Trip): 
              <span class="value">{{ calculatedDrivingTimeMinutes }} mins</span>
          </p>
           <p class="estimate-detail">
              Estimated Traveling Fees: 
              <span class="value">$ {{ calculatedTravelFees(calculatedDrivingTimeMinutes) }}</span>
          </p>
          <p class="estimate-text final-price">
              Estimated Total Fee: 
              <span class="value">{{ calculatedJobFee | currency:'USD':'symbol':'1.0-2' }}</span>
          </p>
      </div>
      
      <button 
        class="request-btn" 
        [disabled]="!selectedStartTime || selectedDurationHours < 1 || !seekerJobLocation || calculatedJobFee === 0" 
        (click)="sendBookingRequestFromModal()">
        Confirm & Send Request
      </button>

    </div>
  </div> -->
}

<mat-card class="reviews-section">
    <h3>Customer Reviews ({{ (reviews$ | async)?.length || 0 }})</h3>
    
    @if (averageRating$ | async; as avg) {
    <div class="average-rating-display">
        <mat-icon class="large-star">star</mat-icon>
        <span class="score">{{ avg.toFixed(1) }}</span>
        <span class="max-score">/ 5</span>
        <span class="count">({{ (reviews$ | async)?.length || 0 }} total ratings)</span>
    </div>
    }

    <div class="review-list">
    @for (review of reviews$ | async; track review.id) {
        <div class="review-item">
        <div class="review-header">
            <div class="stars-display">
            @for (i of [1, 2, 3, 4, 5]; track i) {
                <mat-icon class="star" [class.filled]="review.rating! >= i">star</mat-icon>
            }
            </div>
            <span class="review-date">{{ review.addedDate | date:'mediumDate' }}</span> 
        </div>
        <p class="review-text">{{ review.review }}</p>
        </div>
    } @empty {
        <p class="no-reviews">Be the first to leave a review!</p>
    }
    </div>
</mat-card>
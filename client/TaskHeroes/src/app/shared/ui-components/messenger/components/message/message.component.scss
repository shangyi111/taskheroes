/* --- Variables --- */
$primary-color: #007bff;
$message-sent-bg: #dcf8c6; // Light green/blue for sent
$message-received-bg: #ffffff; // White/light gray for received
$timestamp-color: #888;
$border-color: #e0eeef; // Light border for received messages

:host {
    display: block; // Ensures the component takes full width
    margin-bottom: 12px;
}

.message-container {
    display: flex;
    max-width: 80%; /* Limit the message bubble's width */
    align-items: flex-end; /* Aligns avatar/timestamp with the bottom of the bubble */
    
    /* --- RECEIVED (LEFT ALIGNMENT) --- */
    &.received {
        margin-right: auto; /* Pushes the entire container to the left */
        justify-content: flex-start;
    }
    
    /* --- SENT (RIGHT ALIGNMENT) --- */
    &.sent {
        margin-left: auto; /* Pushes the entire container to the right */
        justify-content: flex-end;
    }

    // Global System Overlay
    &.system-message {
        .message-bubble {
            background-color: #f8fafc; // Neutral background
            color: #64748b;            // Muted slate text
            border: 1px solid #e2e8f0;
            box-shadow: none;
            padding: 6px 12px;
            display: flex;
            align-items: center;
            gap: 6px;

            .message-text {
                font-size: 11px;
                font-weight: 600;
                text-transform: none; // Keep it readable
                letter-spacing: 0;
            }

            .system-icon {
                font-size: 14px;
                color: #94a3b8;
            }
        }

        // Keep the timestamps small and muted
        .message-timestamp {
            text-align: inherit; 
            opacity: 0.7;
        }
    }
}

/* --- Avatar Styling (Received only) --- */
.message-avatar {
    margin-right: 8px;
    margin-bottom: 4px; /* Slight lift to align visually with the bubble */
    
    .avatar-img {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        object-fit: cover;
        border: 1px solid #ddd;
    }
}

.message-bubble-group {
    display: flex;
    flex-direction: column;
}

/* --- Bubble Styling --- */
.message-bubble {
    padding: 10px 14px;
    line-height: 1.4;
    word-wrap: break-word;
    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
    
    .message-text {
        margin: 0;
    }
    
    /* Sent Message Look */
    .message-container.sent & {
        background-color: $message-sent-bg;
        color: #333;
        border-radius: 18px 18px 4px 18px; /* Sharp corner on the bottom-right */
    }
    
    /* Received Message Look */
    .message-container.received & {
        background-color: $message-received-bg;
        color: #333;
        border: 1px solid $border-color;
        border-radius: 18px 18px 18px 4px; /* Sharp corner on the bottom-left */
    }
}

/* --- Timestamp Styling --- */
.message-timestamp {
    font-size: 0.7rem;
    color: $timestamp-color;
    margin-top: 2px;
    
    /* Aligned with the bubble */
    .message-container.sent & {
        text-align: right;
        margin-right: 5px;
    }

    .message-container.received & {
        text-align: left;
        margin-left: 5px;
    }
}
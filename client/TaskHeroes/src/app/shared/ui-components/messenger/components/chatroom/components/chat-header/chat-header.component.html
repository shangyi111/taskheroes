 <header class="chat-header">
    <button class="mobile-menu-toggle" (click)="backClicked.emit()">
        <i class="material-icons">arrow_back</i>
    </button>
    <div class = "chat-header-mid-section">
        @if (jobDetails(); as details) {
            <div class="chat-title-group">
                <div class="chat-partner-avatar">
                    <img [src]="imgError() ? DEFAULT_AVATAR : (chatPartnerAvatarUrl() || DEFAULT_AVATAR)" 
                    (error)="handleImgError($event)"
                    class="avatar-img">
                    
                </div>
                <h1 class="chat-title">
                    {{ chatPartnerName() }}   
                </h1>
            </div>
            @if (headerState(); as actions) {
                        <div class="status-actions">
                        
                            @if (actions.showAccept || actions.showDecline) {
                                <div class="btn-group">
                                    <button class="status-btn decline" (click)="handleDeclineClick()">Decline</button>
                                    <button class="status-btn accept" (click)="updateStatus(JobStatus.Accepted)">Accept Job</button>
                                </div>
                            }

                            @if (actions.showReviewAction) {
                                <div class="review-action-wrapper">
                                    <button class="status-btn review" (click)="reviewOpened.emit()">
                                        {{ actions.reviewActionLabel }}
                                    </button>
                                </div>
                            }

                            @if (actions.showCancel) {
                                <button class="status-btn cancel" (click)="updateStatus(JobStatus.Cancelled)">Cancel</button>
                            }
                        </div>
                    }
        }
    </div>
    <div class="chat-options">
        <p class="detail-link" (click)="detailsOpened.emit()">View details</p>
    </div>
</header>

@if (showDeclineModal()) {
    <decline-reason-dialog
        (confirm)="onDeclineConfirm($event)"
        (cancel)="showDeclineModal.set(false)">
    </decline-reason-dialog>
}
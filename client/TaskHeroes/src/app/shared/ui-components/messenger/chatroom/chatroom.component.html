<div class="chatroom-container">
    <div class="chatroom-main">
        <header class="chat-header">
            <button class="mobile-menu-toggle">
                <i class="material-icons" (click)="backToChatList()">arrow_back</i>
            </button>
            <h1 class="chat-title">{{ chatroom()?.name || 'Loading Chat...' }}</h1>
            <div class="chat-options">
                <p>details</p>
            </div>
        </header>

        <main class="message-area" #messageContainer> <div *ngIf="isLoading()">
                <p>Loading messages...</p>
            </div>
            <div *ngIf="error()" class="error-message">
                <p>{{ error() }}</p>
                <button (click)="ngOnInit()">Retry</button>
            </div>

            <ng-container *ngFor="let message of messages(); trackBy: messageTrackBy">
                <th-message
                [message]="message"
                [currentUserId]="currentUser()? currentUser()!.id! : null">
                ></th-message>
            </ng-container>

            </main>

        <footer class="message-input-area">
            <div class="input-actions">
                <i class="material-icons">attach_file</i>
                <i class="material-icons">mic</i>
            </div>
            <textarea
                [(ngModel)]="newMessageContent"
                placeholder="Type your message..."
                rows="1"
                (keydown.enter)="sendMessage()"
            ></textarea>
            <button class="send-button" (click)="sendMessage()" [disabled]="!newMessageContent().trim()">
                <i class="material-icons">send</i>
            </button>
        </footer>
    </div>
</div>